<!DOCTYPE html>

<head>
	<script>
		process = {
			env: {
				NODE_ENV: "production"
			}
		}
	</script>
	<script type="importmap">
    {
      "imports": {
        "@reduxjs/toolkit": "./scripts/deps/redux_bundled.js",
        "wctk": "./scripts/deps/wctk_bundled.js",
        "components": "./scripts/components/mod.js"
      }
    }
  </script>
	<script type="module" src="./mod.js"></script>

	<style>
		:root {
			--blue: #3478f5;
			--pink: #f534db;
			--dark-gray: #434343;
			--border: 4px solid var(--dark-gray);
			--border-radius: 4px;

			font-family: monospace;
			line-height: 1.5rem;
		}

		[wctk] {
			color: var(--blue);
		}

		[redux] {
			color: var(--pink);
		}
	</style>
</head>

<body>
	<header>
		<h1>
			<span wctk>WCTK</span> + <span redux>Redux</span>
		</h1>
		<p>
			The example below demonstrates how to subscribe webcomponents
			to a redux store using
			<a href="https://github.com/w-lfpup/wctk-js/" target="_blank">the web component toolkit</a>.
		</p>
		<p>
			The <span>shape-controls</span> component dispatches actions to a datastore, while the <span>shape-list</span>
			and <span>shape-count</span> components listen for state updates from the datastore.
		</p>
	</header>
	<main>
		<section>
			<shape-controls>
				<template shadowrootmode="closed">
					<style>
						:host {
							display: inline-block;
						}

						button {
							background: transparent;
							border: var(--border, initial);
							border-radius: var(--border-radius);
							font-family: monospace;
							min-inline-size: 2.5rem;
							min-block-size: 2.5rem;
							cursor: pointer;
						}

						button[type=reset] {
							inline-size: 100%;
						}

						div:not(:first-of-type) {
							margin-block-start: 1rem;
						}
					</style>
					<div>
						<button action="shapes/decrement_circles">-</button>
						circles
						<button action="shapes/increment_circles">+</button>
					</div>
					<div>
						<button action="shapes/decrement_squares">-</button>
						squares
						<button action="shapes/increment_squares">+</button>
					</div>
					<div>
						<button type="reset" action="shapes/reset">reset</button>
					</div>
				</template>
			</shape-controls>
		</section>
		<shape-list>
			<template shadowrootmode="closed">
				<style>
					ul {
						padding: 0;
						list-style: none;
					}

					slot {
						display: flex;
						flex-wrap: wrap;
						gap: 1rem;
					}

					::slotted([shape]) {
						position: relative;
						block-size: 3rem;
						inline-size: 3rem;
						background: var(--blue);
					}

					::slotted([shape="circle"]) {
						background: var(--pink);
						border-radius: 2rem;
					}

					::slotted([shape])::after {
						content: "";
						display: block;
						position: absolute;
						box-sizing: border-box;
						inset-block-start: 0.4rem;
						inset-inline-start: 0.4rem;
						block-size: 3rem;
						inline-size: 3rem;
						border: var(--border);
					}

					::slotted([shape="circle"])::after {
						border-radius: 2rem;
					}
				</style>
				<ul>
					<slot></slot>
				</ul>
			</template>

			<li shape="square"></li>
			<li shape="circle"></li>
			<li shape="square"></li>
			<li shape="square"></li>
			<li shape="circle"></li>
			<li shape="circle"></li>
			<li shape="square"></li>
			<li shape="square"></li>
			<li shape="square"></li>
			<li shape="circle"></li>
		</shape-list>
		<shape-table>
			<template shadowrootmode="closed">
				<style>
					table {
						border-collapse: collapse;
					}

					td:last-child {
						padding-inline-start: 2ch;
					}

					::slotted([slot="circle_count"]) {
						color: var(--pink, inherit);
					}

					::slotted([slot="square_count"]) {
						color: var(--blue, inherit);
					}
				</style>
				<table>
					<tr>
						<td>circles</td>
						<td>
							<slot name="circle_count"></slot>
						</td>
					</tr>
					<tr>
						<td>squares</td>
						<td>
							<slot name="square_count"></slot>
						</td>
					</tr>
					<tr>
						<td>total</td>
						<td>
							<slot name="total"></slot>
						</td>
					</tr>
				</table>
			</template>

			<span slot="circle_count">4</span>
			<span slot="square_count">6</span>
			<span slot="total">10</span>
		</shape-table>
	</main>
</body>